START -> BLOCK ~ 1.0;

BLOCK -> STATEMENT NEWLINE BLOCK ~ 20 | 
	 STATEMENT NEWLINE STACK ~ 1;

STATEMENT -> ARITHMETIC_STATEMENT ~ 1 |
	     RELATIONAL_STATEMENT ~ 1 |
	     CONTROL_STATEMENT ~ 1 |
	     TYPE_STATEMENT ~ 1 |
	     ARRAY_STATEMENT ~ 1 |
	     DICT_STATEMENT ~ 1 |
	     FACTORIAL ~ 0 |
	     MATRIX_STATEMENT ~ 1 |
	     PAINT_STATEMENT ~ 1 |
	     TRANSFORM_STATEMENT ~ 1 |
	     STACK_STATEMENT ~ 0.5 |
	     COUNT ~ 0.25 |
	     MARK ~ 0.25 |
	     CLEARTOMARK ~ 0.25 |
	     CLEAR ~ 0.25 |
	     SHOWPAGE ~ 0.1 |
	     STROKE ~ 0.1 |
	     INTEGER INTEGER MOVETO STRING SHOW ~ 0.1 |
	     EQUALS ~ 0.1 |
	     SAVE RESTORE ~ 0.1 |
	     PROC BIND ~ 0.1 |
	     NULL ~ 0.1 |
	     GSAVE ~ 0.1 |
	     GRESTORE ~ 0.1 |
	     STRING PRINT ~ 0.2;

ARITHMETIC_STATEMENT -> NUMBER NUMBER ADDITION ~ 20 |
		     NUMBER NUMBER SUBTRACTION ~ 20 |
		     NUMBER NUMBER DIVISION ~ 20 |
		     NUMBER NUMBER MULTIPLICATION ~ 20 |
		     NUMBER SQRT ~ 20 |
		     NUMBER NUMBER EXP ~ 20 |
		     NUMBER LOG ~ 20;

RELATIONAL_STATEMENT -> NUMBER NUMBER GT ~ 1 |
		     STRING STRING GT ~ 1 |
		     NUMBER NUMBER LT ~ 1 |
		     STRING STRING LT ~ 1;

CONTROL_STATEMENT -> EXEC ~ 1 |
		     RELATIONAL_STATEMENT PROC IF ~ 1 |
		     RELATIONAL_STATEMENT PROC PROC IFELSE ~ 1 |
		     INTEGER INTEGER INTEGER PROC FOR ~ 1 |
		     ARRAY_DECL EXECSTACK ~ 1;

TYPE_STATEMENT -> CVLIT ~ 1 |
		  CVX ~ 1 |
		  NUMBER CVI ~ 1 |
		  STRING CVI ~ 1 |
		  STRING CVN ~ 1 |
		  NUMBER CVR ~ 1 |
		  NUMBER NATURAL CVRS ~ 1;

MATRIX_STATEMENT ->	MATRIX ~ 1 |
			MATRIX MATRIX MATRIX CONCATMATRIX ~ 1 |
			MATRIX MATRIX INVERTMATRIX ~ 1 |
			MATRIX SETMATRIX ~ 1;

PAINT_STATEMENT -> NUMBER NUMBER NUMBER NUMBER NUMBER ARC ~ 1 |
		   NUMBER NUMBER MOVETO NUMBER NUMBER NUMBER NUMBER NUMBER ARCTO ~ 1 |
		   NUMBER NUMBER MOVETO STRING BOOL CHARPATH ~ 1 |
		   CLIP ~ 1 |
		   CLIPPATH ~ 1 |
		   CLOSEPATH ~ 1 |
		   FLATTENPATH ~ 1 |
		   NUMBER NUMBER MOVETO NUMBER NUMBER LINETO ~ 1 |
		   NEWPATH ~ 1 |
		   PATHFORALL_DECL ~ 1 |
		   NUMBER NUMBER MOVETO NUMBER NUMBER RLINETO ~ 1 |
		   ARRAY_DECL NUMBER SETDASH ~ 1 |
		   LINE_NUM SETLINECAP ~ 1 |
		   LINE_NUM SETLINEJOIN ~ 1 |
		   NATURAL SETMITERLIMIT ~ 1 |
		   NATURAL NUMBER CURRENTHALFTONE SETSCREEN ~ 1 |
		   CURRENTTRANSFER SETTRANSFER ~ 1 |
		   STROKEPATH ~ 1;
			 
TRANSFORM_STATEMENT ->	NUMBER ROTATE ~ 1 |
			NUMBER NUMBER TRANSLATE ~ 1 |
			NUMBER NUMBER MATRIX TRANSLATE ~ 1;

STACK_STATEMENT ->   NATURAL COPY ~ 20 |
		     NATURAL INDEX ~ 20 |
		     NATURAL INTEGER ROLL ~ 20;
	     
ARRAY_STATEMENT -> ARRAY_DECL LENGTH ~ 1 |
		   ARRAY_DECL ALOAD ~ 1 |
		   ARRAY_DECL ZERO NATURAL GETINTERVAL ~ 1 |
		   ARRAY_DECL NATURAL GET ~ 1 |
		   ARRAY_DECL ZERO NUMBER PUT ~ 1 |
		   ARRAY_DECL ZERO LB ELEMS RB PUTINTERVAL ~1 | 
		   INTEGER INT_ARRAY_DECL LBRK OPERATION RBRK FORALL ~ 1 |
		   ARRAY_DECL ARRAY_DECL COPY ~ 1;

STRING_STATEMENT -> INTEGER STRINGCMD ~ 1 |
		    STRING STRING SEARCH ~ 1 |
		    STRING TOKEN ~ 1 |
		    STRING STRING COPY ~ 1;

DICT_STATEMENT -> DICT_DECL LENGTH ~ 1 |
		  DICT_DECL BEGIN ~ 1 |
		  END ~ 1 |
		  KEY_VAL_PAIR DEF ~ 1 |
		  STRING LOAD ~ 1 |
		  KEY_VAL_PAIR STORE ~ 1 |
		  DICT_DECL DICT_DECL COPY ~ 1;

DICT_DECL -> DICT_LEFT KEY_VAL_PAIRS DICT_RIGHT ~ 8 |
	     INTEGER DICT ~ 1;

INT_ARRAY_DECL -> LB INT_ELEMS RB ~ 1;

ARRAY_DECL -> LB ELEMS RB ~ 25 |
	      INTEGER ARRAY ~ 1;

PATHFORALL_DECL -> LBRK NUMBER NUMBER MOVETO RBRK
		   LBRK NUMBER NUMBER LINETO RBRK
		   LBRK NUMBER NUMBER CURVETO RBRK
		   CLOSEPATH ~ 1;

KEY_VAL_PAIRS -> KEY_VAL_PAIR KEY_VAL_PAIRS ~ 8 |
	         KEY_VAL_PAIR ~ 1;

KEY_VAL_PAIR -> STRING NUMBER ~ 1 |
		NUMBER STRING ~ 1 |
		STRING STRING ~ 1 |
		NUMBER NUMBER ~ 1;

ELEMS -> STRING ELEMS ~ 3 | 
	NUMBER ELEMS ~ 3 | 
	STRING ~ 1 | 
	NUMBER ~ 1;

INT_ELEMS -> NUMBER INT_ELEMS ~ 3 |
	    NUMBER ~ 1;

LINE_NUM ->	ZERO ~ 1 |
		ONE ~ 1 |
		TWO ~ 1;

OPERATION -> ADDITION ~ 1 | 
             DIVISION ~ 1 | 
             EXP ~ 1 | 
             MULTIPLICATION ~ 1 | 
             SQRT ~ 1 | 
             SUBTRACTION ~ 1; 

NUMBER -> INTEGER ~ 1 |
	  REAL ~ 1;

BOOL -> TRUE ~ 1 |
	FALSE ~ 1;

PROC -> LBRK STRING RBRK ~ 1;

----------
TRUE -> true;
FALSE -> false;
ZERO -> 0;
ONE -> 1;
TWO -> 2;
THREE -> 3;
FOUR -> 4;
FIVE -> 5;
SIX -> 6;
SEVEN -> 7;
EIGHT -> 8;
NINE -> 9;
THOUSAND -> 1000;
STACK -> stack;
INTEGER -> ~int~;
NATURAL -> ~nat~;
REAL -> ~real~;
NEWLINE -> ~newline~;
MULTIPLICATION -> mul;
ADDITION -> add;
ARC -> arc;
ARCTO -> arcto;
CHARPATH -> charpath;
COPY -> copy;
CLIP -> clip;
CLIPPATH -> clippath;
CLOSEPATH -> closepath;
CONCATMATRIX -> concatmatrix;
CURRENTHALFTONE -> currenthalftone;
CURRENTTRANSFER -> currenttransfer;
CURVETO -> curveto;
DIVISION -> div;
EXP -> exp;
FLATTENPATH -> flattenpath;
INDEX -> index;
INVERTMATRIX -> invertmatrix;
LINETO -> lineto;
LOG -> log;
MATRIX -> matrix;
MARK -> mark;
MOVETO -> moveto;
NEWPATH -> newpath;
PATHFORALL -> pathforall;
RLINETO -> rlineto;
ROLL -> roll;
ROTATE -> rotate;
SETDASH -> setdash;
SETLINECAP -> setlinecap;
SETLINEJOIN -> setlinejoin;
SETMATRIX -> setmatrix;
SETMITERLIMIT -> setmiterlimit;
SETSCREEN -> setscreen;
SETTRANSFER -> settransfer;
SQRT -> sqrt;
STRING -> ~string~;
STROKEPATH -> strokepath;
SUBTRACTION -> sub;
TRANSLATE -> translate;
LB -> [;
RB -> ];
LP -> (;
RP -> );
LENGTH -> length;
ALOAD -> aload;
GET -> get;
COUNT -> count;
GETINTERVAL -> getinterval;
ARRAY -> array;
PUT -> put;
PUTINTERVAL -> putinterval;
DICT_LEFT -> <<;
DICT_RIGHT -> >>;
DICT -> dict;
ASTORE -> astore;
FORALL -> forall;
LBRK -> {;
RBRK -> };
CLEARTOMARK -> cleartomark;
CLEAR -> clear;
SHOWPAGE -> showpage;
STROKE -> stroke;
MOVETO -> moveto;
SHOW -> show;
EQUALS -> =;
SAVE -> save;
RESTORE -> restore;
BIND -> bind;
NULL -> null;
GSAVE -> gsave;
GRESTORE -> grestore;
FACTORIAL -> /factorial { 1 dict begin
/n exch def
n 0 eq {
1
}{
n n 1 sub factorial mul
} ifelse
end } def;
BEGIN -> begin;
END -> end;
DEF -> def;
LOAD -> load;
STORE -> store;
STRINGCMD -> string;
SEARCH -> search;
TOKEN -> token;
GT -> gt;
LT -> lt;
EXEC -> exec;
IF -> if;
IFELSE -> ifelse;
FOR -> for;
EXECSTACK -> execstack;
CVLIT -> cvlit;
CVX -> cvx;
CVI -> cvi;
CVN -> cvn;
CVR -> cvr;
CVRS -> cvrs;
PRINT -> print;

